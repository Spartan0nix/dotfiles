---
- name: Create .path file
  file:
    path: "{{ ansible_user_dir }}/.path"
    state: touch

- name: Update default PATH
  lineinfile:
    path: "{{ ansible_user_dir }}/.path"
    regexp: '^PATH="/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/usr/lib/wsl/lib"'
    line: 'PATH="/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/usr/lib/wsl/lib"'

- name: Include .path file in bashrc
  lineinfile:
    path: "{{ ansible_user_dir }}/.bashrc"
    regexp: '^source ~/.path'
    line: 'source ~/.path'
  register: bashrc_update

- name: Add documentation for .path import in bashrc
  lineinfile:
    path: "{{ ansible_user_dir }}/.bashrc"
    insertbefore: '^source ~/.path'
    line: "\n# Source file containing path update"
  when: bashrc_update.changed

- name: Include .path file in zshrc
  lineinfile:
    path: "{{ ansible_user_dir }}/.zshrc"
    regexp: '^source ~/.path'
    line: 'source ~/.path'
    create: yes
  register: zshrc_update

- name: Add documentation for .path import in zshrc
  lineinfile:
    path: "{{ ansible_user_dir }}/.zshrc"
    insertbefore: '^source ~/.path'
    line: "\n# Source file containing path update"
  when: zshrc_update.changed